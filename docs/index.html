<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Detection and analysis of insect defoliation in tree rings • dfoliatR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Detection and analysis of insect defoliation in tree rings">
<meta property="og:description" content="A package to replicate and build on the OUTBREAK fortran program written by Richard Holmes.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">dfoliatR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/introduction.html">Introduction to dfoliatR</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/chguiterman/dfoliatR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="contents col-md-9">
<div id="dfoliatr" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#dfoliatr" class="anchor"></a>dfoliatR</h1></div>
<p><strong>Please note</strong> This R package is under development. All functions are preliminary. Output results should be (and are being) validated with other software and analyses. Anyone applying the software does so at their own risk. However, we are open to further colaboration and contributions. Please contact the lead developer, Chris Guiterman, and fork the software to continue with development. Thank you.</p>
<p><a href="https://travis-ci.org/chguiterman/dfoliatR"><img src="https://travis-ci.org/chguiterman/dfoliatR.svg?branch=master" alt="Build Status"></a> <a href="https://coveralls.io/github/chguiterman/dfoliatR?branch=master"><img src="https://coveralls.io/repos/github/chguiterman/dfoliatR/badge.svg?branch=master" alt="Coverage Status"></a></p>
<div id="installation" class="section level3">
<h3 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h3>
<p><code>dfoliatR</code> is not currently on CRAN. To install <code>dfoliatR</code> use the <code>devtools</code> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(devtools)

<span class="kw">install_github</span>(<span class="st">"chguiterman/dfoliatR"</span>)</code></pre></div>
<p>Once installed, <code>dfoliatR</code> can be called like any other R package</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dfoliatR)</code></pre></div>
</div>
<div id="data" class="section level3">
<h3 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h3>
<p><code>dfoliatR</code> requires two independent datasets:</p>
<ul>
<li>Host-tree series, of one or more individual trees (not cores), as standardized ring widths. To average cores and obtain individual tree series, see <code>dplr::treeMean</code>.</li>
<li>A non-host standardized tree-ring chronology.</li>
</ul>
<p>These datasets can be created in ARSTAN or by with the <code>detrend()</code> function in the <code>dplR</code> library. A chronology can be created in <code>dplR</code> with the <code>chron()</code> function. Once read into R, the data can be passed to <code>dfoliatR</code> functions. They must share the formatting of <code>rwl</code> objects in <code>dplR</code>.</p>
<p>Data are provided in this package to demonstrate some of the utilities of <code>dfoliatR</code>, courtesy of Dr. Ann Lynch.</p>
<p>Here, we can read in Douglas-fir host series from the East Fork site in the Jemez Mountains, <code>ef</code>. These are standardized tree-ring index for individual trees.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(ef_h)

<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(ef_h)[<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>] <span class="co"># note the formatting of this rwl object</span></code></pre></div>
<p>We compared these trees against a non-host chronology from a nearby site. The BAC chronology is from ponderosa pine at the Baca site in the Jemez Mountains.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(ef_nh)</code></pre></div>
</div>
<div id="operation" class="section level3">
<h3 class="hasAnchor">
<a href="#operation" class="anchor"></a>Operation</h3>
<p><code>dfoliatR</code> employs the same processes as the FORTRAN program OUTBREAK, developed by Richard Holmes and Thomas Swetnam.</p>
<p>The first thing to do is perform the “correction” on the host trees using the <code><a href="reference/defoliate_trees.html">defoliate_trees()</a></code> function. This removes the growth signal of the non-host chronology to reduce the influence of climate from the host trees, providing clearer ecological variability that might relate to defoliation events.</p>
<p>Once corrected, <code>defoliate_trees</code> will employ runs analyses to identify defoliation periods in each tree. Some parameters regarding the length and severity of growth departure can be changed by the user. The parameter defaults follow those in OUTBREAK. Definitions of the function parameters are provided with <code><a href="reference/defoliate_trees.html">?defoliate_trees</a></code></p>
<p>To run the function, follow the script below, making a new object with the results. This output dataset is termed by <code>dfoliatR</code> as a “defol” object to aid the functions in seeing that it represents individual trees as opposed to a composited site-level dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ef_defol &lt;-<span class="st"> </span><span class="kw"><a href="reference/defoliate_trees.html">defoliate_trees</a></span>(<span class="dt">host_tree =</span> ef_h, <span class="dt">nonhost_chron =</span> ef_nh, 
      <span class="dt">duration_years =</span> <span class="dv">8</span>, <span class="dt">max_reduction =</span> <span class="op">-</span><span class="fl">1.28</span>, <span class="dt">list_output =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>We can view the individual time series and the defoliation periods identified by the function by plotting the new <code>defol</code> object in a stacked graph:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/plot_defol.html">plot_defol</a></span>(ef_defol)</code></pre></div>
<p>The <code><a href="reference/plot_defol.html">plot_defol()</a></code> function allows for a color change of the defoliation events with the parameter <code>col_defol</code>. The default is “black”, but any color can be used by using names (e.g., “red”), color codes (e.g., “#8B4500”), or numeric color indicators (e.g., 3).</p>
<p>Basic and informative tree-level statistics regarding the sample data and defoliation events can be viewed by</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/defol_stats.html">defol_stats</a></span>(ef_defol)</code></pre></div>
<p>It is important to note that<code>dfoliatR</code> distinguishes between a “defoliation event”, recorded on individual trees, and an “outbreak” that synchronously effected a proportion of trees.</p>
<p>Outbreak periods can be identified with the function <code>outbreak</code>. In essence, this is a compositing function that combines all trees provided in the “defol” object to assess the synchrony and scale of defoliation. Should enough trees record defoliation (regardless of the duration), it will be termed an “outbreak”. Filter parameters control the percent of trees in defoliation and minimum number of trees required to be considered an outbreak. Short outbreaks can be removed after running <code><a href="reference/outbreak_stats.html">outbreak_stats()</a></code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ef_comp &lt;-<span class="st"> </span><span class="kw"><a href="reference/outbreak.html">outbreak</a></span>(ef_defol, <span class="dt">comp_name =</span> <span class="st">"EF"</span>, <span class="dt">filter_perc =</span> <span class="dv">25</span>, 
                    <span class="dt">filter_min_series =</span> <span class="dv">3</span>)</code></pre></div>
<p>As with the “defol” object, basic statistics and graphics are available for the new “outbreak” object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/outbreak_stats.html">outbreak_stats</a></span>(ef_comp)

<span class="kw"><a href="reference/plot_outbreak.html">plot_outbreak</a></span>()</code></pre></div>
<p>The intervals between outbreak events can be assessed by extracting representative year for each event. <code>outbreak_stats</code> provides several options:</p>
<ol>
<li>The first year of outbreak</li>
<li>the year with the greatest number of defoliated trees</li>
<li>the year with the greatest departure in growth.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ef_outbrk &lt;-<span class="st"> </span><span class="kw"><a href="reference/outbreak_stats.html">outbreak_stats</a></span>(ef_comp)

<span class="co"># remove outbreaks lasting less than 10 years (n=1 in this case)</span>
ef_outbrk &lt;-<span class="st"> </span>ef_outbrk[ef_outbrk<span class="op">$</span>duration <span class="op">&gt;=</span><span class="st"> </span><span class="dv">10</span>, ]

<span class="co"># calculate intervals based on the year with the most defoliated trees</span>
ef_interv &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/diff">diff</a></span>(ef_outbrk<span class="op">$</span>peak_outbreak_year)</code></pre></div>
<p>This produces a simple vector of intervals. We can plot it and calculate basic stats</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/hist">hist</a></span>(ef_interv, <span class="dt">xlab=</span><span class="st">"Intervals (years)"</span>, <span class="dt">main =</span> <span class="st">"Outbreak intervals at East Fork"</span>)

<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/boxplot">boxplot</a></span>(ef_interv, <span class="dt">horizontal =</span> <span class="ot">TRUE</span>, <span class="dt">xlab=</span><span class="st">"Intervals (years)"</span>, <span class="dt">ylab =</span> <span class="st">"East Fork Douglas-fir"</span>)

<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(ef_interv)
<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/median">median</a></span>(ef_interv)</code></pre></div>
<div id="questions-concerns-problems-ideas-want-to-contribute" class="section level4">
<h4 class="hasAnchor">
<a href="#questions-concerns-problems-ideas-want-to-contribute" class="anchor"></a>Questions, concerns, problems, ideas, want to contribute?</h4>
<p>Please contact the author, Chris Guiterman</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/chguiterman/dfoliatR">https://​github.com/​chguiterman/​dfoliatR</a>
</li>
<li>Report a bug at <br><a href="http://github.com/chguiterman/dfoliatR/issues">http://​github.com/​chguiterman/​dfoliatR/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 3)</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Christopher H Guiterman <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

  </div>
</div>

      <footer><div class="copyright">
  <p>Developed by Christopher H Guiterman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
